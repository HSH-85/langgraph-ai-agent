# 성능 비교 가이드

금융 특화 버전과 기본 버전의 성능을 비교하는 방법입니다.

## 사용 방법

### 1. Python 스크립트로 비교 실행

```bash
cd langgraph-ai-agent
python compare_versions.py
```

특정 질문으로 테스트:
```bash
python compare_versions.py "삼성전자 주가는 얼마인가요?"
```

### 2. 비교 결과 확인

스크립트 실행 후 다음 정보를 확인할 수 있습니다:

#### 기본 메트릭
- **문서 개수**: 수집된 문서 수
- **루프 횟수**: 재시도 횟수
- **의도 분석**: 질문 의도 분류 결과
- **관련성 평가**: 문서 관련성 평가 결과
- **답변 길이**: 생성된 답변의 길이 (자)
- **사고 과정 단계 수**: 실행된 노드/단계 수

#### 성능 메트릭 ⭐
- **실행 시간**: 전체 실행 소요 시간 (초)
  - 기본 버전 vs 금융 특화 버전 비교
  - 시간 차이 표시
- **예상 LLM 호출 횟수**: LLM API 호출 추정 횟수
  - 기본 버전 vs 금융 특화 버전 비교

#### 금융 특화 메트릭 (고도화 버전만)
- **금융 도메인**: 질문의 금융 도메인 분류
- **신뢰도 점수**: 0.0 ~ 1.0 사이의 신뢰도
- **소스 일치도**: high/medium/low
- **검색 라운드**: 실행된 검색 라운드 수
- **검증 라운드**: 실행된 검증 라운드 수

### 3. 전체 테스트 요약

여러 질문으로 테스트하면 다음 통계를 확인할 수 있습니다:

- 평균 문서 개수 증가
- 평균 신뢰도
- 다중 검색 실행 비율
- 검증 실행 비율
- **평균 실행 시간 비교**
- **평균 LLM 호출 횟수 비교**

## 성능 지표 해석

### 실행 시간
- **양수 (+)**: 금융 특화 버전이 더 오래 걸림
  - 이유: 추가 검색/검증 단계로 인해 더 정확하지만 시간이 더 소요
- **음수 (-)**: 금융 특화 버전이 더 빠름
  - 이유: 효율적인 검색으로 불필요한 반복 제거

### LLM 호출 횟수
- 금융 특화 버전은 다음으로 인해 호출 횟수가 증가할 수 있습니다:
  - 금융 도메인 분석 (1회 추가)
  - 문서 검증 (최대 2라운드)
  - 크로스 검증 (1회 추가)
  - 신뢰도 계산 (1회 추가)
- 하지만 더 정확한 답변을 제공합니다

### 개선 사항
✅ 표시된 항목은 금융 특화 버전의 개선 사항입니다:
- ✅ 문서 개수 증가: 더 많은 정보 수집
- ✅ 검증 단계 증가: 문서 품질 향상
- ✅ 높은 신뢰도: 신뢰할 수 있는 답변
- ✅ 소스 간 높은 일치도: 여러 소스 확인
- ✅ 다중 검색 라운드: 다양한 관점에서 검색
- ✅ 문서 검증 라운드: 데이터 정확성 검증

## 예시 출력

```
🔹 기본 메트릭 비교
────────────────────────────────────────────────────────────────────────────────
항목                           기본 버전                  금융 특화 버전        
────────────────────────────────────────────────────────────────────────────────
문서 개수                      3                         6                     
루프 횟수                      1                         2                     
의도 분석                      factual                   factual               
관련성 평가                    no                        yes                   
답변 길이 (자)                 245                       387                   
사고 과정 단계 수              5                         9                     
실행 시간                      12.34초                   18.56초 (+6.22초)    
예상 LLM 호출 횟수             4                         7                     

────────────────────────────────────────────────────────────────────────────────
📊 성능 비교 요약
────────────────────────────────────────────────────────────────────────────────
평균 문서 개수 증가: 3.00개
평균 신뢰도: 75.00% (3개 질문 기준)
다중 검색 실행 비율: 3/3 (100.0%)
검증 실행 비율: 2/3 (66.7%)

평균 실행 시간:
  - 기본 버전: 12.34초
  - 금융 특화 버전: 18.56초
  - 시간 차이: +50.4% (+6.22초)

평균 LLM 호출 횟수:
  - 기본 버전: 4.0회
  - 금융 특화 버전: 7.0회
  - 차이: +3.0회
```

## 주의사항

1. **API 비용**: 비교 테스트는 API 호출이 많이 발생하므로 비용이 발생합니다
2. **실행 시간**: 네트워크 상태와 API 응답 시간에 따라 달라질 수 있습니다
3. **정확도 vs 속도**: 금융 특화 버전은 정확도를 위해 시간이 더 걸릴 수 있습니다

## 권장사항

- **정확도가 중요한 경우**: 금융 특화 버전 사용 권장
- **속도가 중요한 경우**: 기본 버전 사용 고려
- **최적의 방법**: 질문의 중요도에 따라 버전 선택

